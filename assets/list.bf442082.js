var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,s=(e,a)=>{for(var l in a||(a={}))o.call(a,l)&&i(e,l,a[l]);if(t)for(var l of t(a))r.call(a,l)&&i(e,l,a[l]);return e},n=(e,t)=>a(e,l(t));import{d,ab as c,aA as p,Y as u,aB as m,V as g,aq as f,r as b,o as h,c as y,w as v,a as w,a0 as k,au as U,am as R,aK as C,Z as _,$ as F,W as j,aL as S,ar as V,a5 as x,a3 as I}from"./vendor.46c44667.js";import{f as O,u as E,c as D,a as B,d as L}from"./home-page-config.d4e64ebc.js";import{l as P}from"./lodash.6789d9fe.js";import{g as A}from"./index.dfc696ff.js";import{u as Q}from"./upload.8836f8eb.js";const T=d({name:"AddSwiperDialog",props:{isEdit:{type:Boolean,default:!1},id:{type:[String,Number],default:""}},emits:["reload"],setup(e,{attrs:a,slots:l,emit:t}){const o={carouselUrl:"",redirectUrl:"",carouselRank:""},r=c(null),i=p({dialogVisible:!1,title:u((()=>e.isEdit?"编辑轮播图":"添加轮播图")),postForm:P.exports.cloneDeep(o),postFormRules:{carouselUrl:[{required:"true",message:"图片不能为空",trigger:["change"]}],carouselRank:[{required:"true",message:"排序不能为空",trigger:["change"]}]},acceptImages:["jpg","jpeg","png"],loading:!1}),d=(e=!1)=>{i.dialogVisible=!1,i.postForm=P.exports.cloneDeep(o),t("reload",{isReload:e})};return n(s({uploadImgServer:Q,token:A()||"",handleBeforeUpload:e=>{const a=e.name.slice(e.name.lastIndexOf(".")+1);if(!i.acceptImages.includes(a))return g.error("请上传 jpg、jpeg、png 格式的图片"),!1},handleUrlSuccess:e=>{i.postForm.carouselUrl=e.data||""},submitForm:()=>{r.value.validate().then((()=>{const a=P.exports.cloneDeep(i.postForm);let l="";e.isEdit?(a.id=e.id,l=E):l=D,i.loading=!0,l(a).then((a=>{g.success(""+(e.isEdit?"编辑成功":"添加成功")),d(!0)})).finally((()=>{i.loading=!1}))})).catch((e=>(console.log(e),!1)))},open:()=>{i.dialogVisible=!0,f((()=>{var a;e.isEdit&&(a=e.id,O(a).then((e=>{i.postForm=Object.assign(i.postForm,e.data)})))}))}},m(i)),{postFormRef:r,emitClose:d,handleCancel:()=>{d(!1)}})}}),q=["src"],z={key:1,class:"el-icon-plus avatar-uploader-icon"},N=U("取 消"),K=U("确 定");T.render=function(e,a,l,t,o,r){const i=b("el-upload"),s=b("el-form-item"),n=b("el-input"),d=b("el-form"),c=b("el-button"),p=b("el-dialog");return h(),y(p,{title:e.title,modelValue:e.dialogVisible,"onUpdate:modelValue":a[2]||(a[2]=a=>e.dialogVisible=a),"destroy-on-close":"","before-close":e.handleCancel},{footer:v((()=>[w(c,{loading:e.loading,onClick:e.handleCancel},{default:v((()=>[N])),_:1},8,["loading","onClick"]),w(c,{loading:e.loading,type:"primary",onClick:e.submitForm},{default:v((()=>[K])),_:1},8,["loading","onClick"])])),default:v((()=>[w(d,{model:e.postForm,rules:e.postFormRules,ref:"postFormRef"},{default:v((()=>[w(s,{label:"图片",prop:"carouselUrl"},{default:v((()=>[w(i,{class:"avatar-uploader",action:e.uploadImgServer,accept:e.acceptImages.join(","),headers:{token:e.token},"show-file-list":!1,"before-upload":e.handleBeforeUpload,"on-success":e.handleUrlSuccess},{default:v((()=>[e.postForm.carouselUrl?(h(),k("img",{key:0,style:{width:"200px",height:"100px",border:"1px solid #e9e9e9"},src:e.postForm.carouselUrl,class:"avatar"},null,8,q)):(h(),k("i",z))])),_:1},8,["action","accept","headers","before-upload","on-success"])])),_:1}),w(s,{label:"跳转链接",prop:"redirectUrl"},{default:v((()=>[w(n,{type:"text",modelValue:e.postForm.redirectUrl,"onUpdate:modelValue":a[0]||(a[0]=a=>e.postForm.redirectUrl=a)},null,8,["modelValue"])])),_:1}),w(s,{label:"排序值",prop:"carouselRank"},{default:v((()=>[w(n,{type:"number",modelValue:e.postForm.carouselRank,"onUpdate:modelValue":a[1]||(a[1]=a=>e.postForm.carouselRank=a)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue","before-close"])};const W=d({name:"SwiperList",components:{AddSwiperDialog:T},setup(e,{attrs:a,slots:l,emit:t}){const o=p({list:[],total:0,listLoading:!1}),r=p({page:1,limit:10}),i=()=>{o.listLoading=!0,B({pageNumber:r.page,pageSize:r.limit}).then((e=>{o.list=e.data.list,o.total=e.data.totalCount})).finally((()=>{o.listLoading=!1}))};R((()=>{i()}));const d=c(null),u=c(""),m=c(!1),f=c([]);return n(s({listQuery:r},C(o)),{getCarouseList:i,swiperDialogRef:d,handleAdd:()=>{var e;null==(e=d.value)||e.open()},handleEdit:e=>{var a;u.value=e.carouselId,m.value=!0,null==(a=d.value)||a.open()},carouselId:u,handleRemove:e=>{j.confirm("此操作将删除该轮播图, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{L([e.carouselId]).then((()=>{g.success("删除成功")}))})).catch((()=>{g.info("已取消删除")}))},isEdit:m,handleReload:({isReload:e})=>{u.value="",m.value=!1,e&&i()},handlebatchRemove:()=>{if(!f.value.length)return g.warning("请先选择需要移除的轮播图！"),!1;const e=f.value.map((e=>e.carouselId));j.confirm("此操作将删除所选的轮播图, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{L(e).then((()=>{g.success("删除成功")}))})).catch((()=>{g.info("已取消删除")}))},multipleSelection:f})}});_("data-v-251ef0b0");const Y={class:"app-container"},Z=U("添加轮播图"),$=U("批量删除"),G=["src"],H=["href"],J=U("编辑"),M=U("移除");F(),W.render=function(e,a,l,t,o,r){const i=b("el-button"),s=b("el-card"),n=b("el-table-column"),d=b("el-table"),c=b("pagination"),p=b("AddSwiperDialog"),u=S("loading");return h(),k("div",Y,[w(s,{class:"operate-container",shadow:"never"},{default:v((()=>[w(i,{type:"primary",onClick:e.handleAdd},{default:v((()=>[Z])),_:1},8,["onClick"]),w(i,{type:"danger",onClick:e.handlebatchRemove,disabled:e.multipleSelection.length<=0},{default:v((()=>[$])),_:1},8,["onClick","disabled"])])),_:1}),V(w(d,{data:e.list,border:"",style:{width:"100%"},onSelectionChange:a[0]||(a[0]=a=>e.multipleSelection=a)},{default:v((()=>[w(n,{type:"selection",width:"55"}),w(n,{align:"center",prop:"carouselId",label:"id",width:"55"}),w(n,{align:"center",prop:"carouselUrl",label:"轮播图"},{default:v((e=>[x("img",{class:"carousel-img",src:e.row.carouselUrl,alt:"轮播图"},null,8,G)])),_:1}),w(n,{align:"center",prop:"redirectUrl",label:"跳转链接"},{default:v((e=>[x("a",{target:"_blank",href:e.row.redirectUrl},I(e.row.redirectUrl),9,H)])),_:1}),w(n,{align:"center",label:"排序值",prop:"carouselRank"}),w(n,{align:"center",label:"添加时间",prop:"createTime"}),w(n,{"header-align":"center",align:"center",label:"操作"},{default:v((a=>[w(i,{type:"primary",onClick:l=>e.handleEdit(a.row)},{default:v((()=>[J])),_:2},1032,["onClick"]),w(i,{type:"danger",onClick:l=>e.handleRemove(a.row)},{default:v((()=>[M])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),[[u,e.listLoading]]),w(c,{total:e.total,page:e.listQuery.page,"onUpdate:page":a[1]||(a[1]=a=>e.listQuery.page=a),limit:e.listQuery.limit,"onUpdate:limit":a[2]||(a[2]=a=>e.listQuery.limit=a),"page-sizes":[10,20,30,50],onPagination:e.getCarouseList},null,8,["total","page","limit","onPagination"]),w(p,{ref:"swiperDialogRef",id:e.carouselId,"is-edit":e.isEdit,onReload:e.handleReload},null,8,["id","is-edit","onReload"])])},W.__scopeId="data-v-251ef0b0";export{W as default};
